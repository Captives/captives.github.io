(function(e){function t(t){for(var n,r,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)r=s[d],i[r]&&p.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={live:0},o=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;o.push([4,"chunk-vendors","chunk-common"]),a()})({4:function(e,t,a){e.exports=a("bf33")},"499b":function(e,t,a){},"4f1e":function(e,t,a){"use strict";var n=a("6113"),i=a.n(n);i.a},"5fc8":function(e,t,a){e.exports=a.p+"static/img/poster_play.941de5cb.png"},6113:function(e,t,a){},"6b3c":function(e,t,a){e.exports=a.p+"static/img/alert-tips.55775449.png"},"6d85":function(e,t,a){},"716c":function(e,t,a){},7209:function(e,t,a){},"9aa9":function(e,t,a){},a104:function(e,t,a){"use strict";var n=a("716c"),i=a.n(n);i.a},b446:function(e,t,a){"use strict";var n=a("499b"),i=a.n(n);i.a},bf33:function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[e.videoData?a("VideoPlayer",{attrs:{videodata:e.videoData}}):e._e(),e.playerror?a("BaseWindow",{staticClass:"alert",attrs:{label:"刷新"},on:{change:e.refreshClick}},[e._v("当前课程数据获取异常，请反馈到我们，我们来尽快帮您处理，谢谢您的谅解 拨打400-163-6161")]):e._e()],1)},o=[],r=(a("a481"),a("3b2b"),a("7f7f"),a("cebc")),s=a("2f62"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("img",{attrs:{src:e.src}}),a("span",[e._t("default")],2),a("a",{staticClass:"button",on:{click:e.clickHandler}},[e._v(e._s(e.label))])])])},c=[],u=a("6b3c"),d=a.n(u),p={name:"BaseWindow",props:{label:{type:String,default:"标签"}},data:function(){return{src:d.a}},methods:{clickHandler:function(e){this.$emit("change")}}},f=p,h=(a("ef21"),a("2877")),m=Object(h["a"])(f,l,c,!1,null,"3d14675e",null),y=m.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fill"},[a("div",{staticClass:"fill player",attrs:{id:"player"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"fill poster"},[e.videodata&&e.videodata.poster?a("img",{staticClass:"fill",attrs:{src:e.videodata.poster}}):e._e()]),e.show||e.playing?e._e():a("div",{staticClass:"fill bg",on:{click:e.playerHander}},[e.videodata&&e.videodata.poster?a("img",{staticClass:"fill",attrs:{src:e.videodata.poster}}):e._e(),a("div",{staticClass:"fill mask"}),a("img",{staticClass:"playbtn",attrs:{src:e.playBtn}})]),e.errorTips?a("BaseWindow",{staticClass:"alert",attrs:{label:"刷新"},on:{change:e.refreshClick}},[e._v("检测到当前网络较差，请刷新重试！")]):e._e()],1)},g=[],b=(a("ac6a"),a("5176")),w=a.n(b),_=a("5392"),O=a.n(_),E=a("9000"),x=a.n(E),C=a("5fc8"),S=a.n(C),j=a("f1c7"),R=a.n(j),T=a("0a0d"),D=a.n(T);a("386d"),a("4917");function k(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null}function P(){var e=location.href;e=e.replace(/&_t=.*$/gi,""),window.location.href=e+"&_t="+D()()}var I,A={components:{BaseWindow:y},props:{videodata:{type:Object,default:function(){}}},data:function(){return{load_gif:R.a,playBtn:S.a,player:null,playing:!1,loading:!1,show:!1,errorTips:null}},computed:{videoshow:function(){return this.isWeixinBrowser()&&this.playing}},methods:{initVideo:function(){var e={id:"player",url:this.videodata.src,fluid:!0,videoInit:!0,poster:this.videodata.poster,playsinline:!0,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,autoplay:!0,volume:1,"x5-video-player-type":"h5"};if(console.log("play",this.videodata.src),this.videodata&&-1!=this.videodata.src.indexOf(".m3u8")){w()(e,{ignores:["progress","time"],closeVideoClick:!0,closeVideoDblclick:!0,closeVideoTouch:!0,closePlayerBlur:!0,closeControlsBlur:!0,closeFocusVideoFocus:!0,closePlayVideoFocus:!0}),this.player=new x.a(e);var t=this;setInterval(function(){t.loading=t.player.inWaitingStart&&t.player.inWaitingStart>0},100),setInterval(function(){t.errorTips=t.player.inWaitingStart},1e4)}else this.player=new O.a(e);this.player.once("ready",this.playerReady),this.player.once("complete",this.playerComplete),this.player.once("destory",this.playerDestory),this.player.on("error",this.playerError),this.player.on("play",this.playerPlay),this.player.on("playing",this.playerPlay),this.player.on("pause",this.playerPause),this.player.on("ended",this.playerPause),window.player=this.player},playerReady:function(){console.log("xgplay --\x3e playerReady")},playerComplete:function(){console.log("xgplay --\x3e playerComplete"),document.querySelector("#player").removeAttribute("style"),this.removeChild(".xgplayer-start"),this.removeChild(".xgplayer-replay");var e=document.querySelectorAll("xg-tips");e.forEach(function(e){e.parentNode.removeChild(e)}),document.querySelector(".xgplayer-loading").innerHTML="<img src='"+this.load_gif+"' alt='loading'>"},playerDestory:function(){console.log("xgplay --\x3e playerDestory")},playerPlay:function(){this.playing=!0},playerPause:function(){this.playing=!1},playerHander:function(){this.player&&this.player.play()},playerError:function(e){console.log("ERROR ->",e)},refreshClick:function(){P()},removeChild:function(e){var t=document.querySelector(e);t&&t.parentNode.removeChild(t)}},mounted:function(){this.videodata&&this.videodata.src?(this.initVideo(),this.show=!1):this.show=!0}},V=A,B=(a("4f1e"),a("a104"),Object(h["a"])(V,v,g,!1,null,"27ca54ea",null)),M=B.exports,W={name:"app",components:{BaseWindow:y,VideoPlayer:M},data:function(){return{checked:!1,loading:!1,classId:null,title:"",roomData:null,videoData:null,heartTimeId:0,playerror:!1}},computed:Object(r["a"])({},Object(s["c"])("page",{page:function(e){return e}})),methods:Object(r["a"])({},Object(s["b"])("page",["onResize"]),{init:function(e){window._hmt;var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?bf270b9861f2d514b0984524dcbccc50",document.querySelector("head").appendChild(t),this.roomData=e,console.log("room data",e),this.getVideoInfo()},getVideoInfo:function(){var e=this,t=this;this.$api.getPlayBackInfo(t.roomData.id).then(function(a){var n=a.isSuccess,i=a.result,o=i.url,r=i.title,s=i.image;n?(e.title=r||"FasTrack English",document.title=e.title,o?t.videoData={type:"video/mp4",src:o,poster:s}:t.getRoomMetaData()):t.getRoomMetaData()}).catch(function(t){e.playerror=!0})},getRoomMetaData:function(){var e=this,t=this;this.$api.getClassInfo(this.roomData.id,this.roomData.name,this.roomData.type).then(function(e){var a=e.isSuccess,n=e.result,i=n.image,o=n.url,r=n.stream;a&&(t.videoData={withCredentials:!1,type:"application/x-mpegURL",src:1==r?o:null,poster:i})}).catch(function(t){e.playerror=!0})},refreshClick:function(){P()}}),mounted:function(){var e=this;function t(e){var t=new RegExp("\\/live\\/[a-zA-Z0-9-_]+","gi"),a=t.exec(window.location.href);return a&&a[0]?a[0].replace(e,""):null}this.onResize(document.documentElement),window.onresize=function(){e.onResize(document.documentElement)},this.checked=!0,this.init({name:t("/live/"),type:k("type"),id:k("roomid")})}},H=W,$=(a("b446"),Object(h["a"])(H,i,o,!1,null,null,null)),N=$.exports,q=a("bd86"),z={SETROOM:"setRoom",UPDATE_STAGE:"updateStage",LEAVE:"LEAVE",ENDTHECLASS:"ENDTHECLASS"},L={namespaced:!0,state:{roomId:1,startTime:1,endTime:1},mutations:(I={},Object(q["a"])(I,z.SETROOM,function(e,t){e.roomId=t.room_id,e.startTime=t.start_time,e.endTime=t.end_time}),Object(q["a"])(I,z.UPDATE_STAGE,function(e,t){e.stageIndex=t}),I),actions:{setRoom:function(e,t){var a=e.commit;a(z.SETROOM,t)},updateStage:function(e,t){var a=e.commit;a(z.UPDATE_STAGE,t)}},getters:{}},F=(a("c5f6"),{ON_RESIZE:"onResize"}),U={namespaced:!0,state:{width:1920,height:1080,padding:0,ratio:1},mutations:Object(q["a"])({},F.ON_RESIZE,function(e,t){e.ratio=t}),actions:{onResize:function(e,t){var a=e.state,n=e.commit,i=t.clientWidth-2*a.padding,o=t.clientHeight-a.padding,r=i/a.width,s=a.height*r;s>o&&(r=o/a.height),n(F.ON_RESIZE,Number(r.toFixed(4)))}},getters:{}};n["default"].use(s["a"]);var Z=new s["a"].Store({modules:{room:L,page:U}}),G=(a("6d85"),a("7209"),a("d225")),J=a("308d"),K=a("6bb5"),Q=a("013f"),X=a("4e2b"),Y=a("90ee"),ee=function(e){function t(){var e;return Object(G["a"])(this,t),e=Object(J["a"])(this,Object(K["a"])(t).call(this)),Object(q["a"])(Object(Q["a"])(e),"getPlayBackInfo",function(t){return e.request("live_playback",{room_id:t})}),Object(q["a"])(Object(Q["a"])(e),"getClassInfo",function(t,a,n){return e.request("live_monitor",{room_id:t,name:a,type:n})}),Object(q["a"])(Object(Q["a"])(e),"testHeart",function(){return e.request("heart")}),e}return Object(X["a"])(t,e),t}(Y["a"]),te={install:function(e){e.prototype.Api=new ee,e.prototype.$api=e.prototype.Api}};n["default"].use(te),n["default"].config.productionTip=!1,window.vm=new n["default"]({store:Z,render:function(e){return e(N)}}).$mount("#app")},ef21:function(e,t,a){"use strict";var n=a("9aa9"),i=a.n(n);i.a},f1c7:function(e,t,a){e.exports=a.p+"static/img/loading.9a34b78d.gif"}});
//# sourceMappingURL=live.efea9566.js.map