(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76417b62"],{2327:function(t,e,i){},"6ea5":function(t,e,i){},"754d":function(t,e,i){"use strict";var a=i("2327"),s=i.n(a);s.a},"7b59":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",[i("gallery",{staticStyle:{width:"300px"},attrs:{column:2,draggable:""}}),i("el-main",[i("div",{staticClass:"flex"},[i("div",{ref:"poster",staticClass:"edit-poster",style:t.imageStyle,on:{drop:function(e){return t.dropHandler(e)},dragover:t.dropoverHandler}},[i("img",{ref:"image",attrs:{src:t.image.url},on:{load:t.imageLoading}}),i("div",{staticClass:"qrcode-legend",style:t.qrStyle,on:{mousedown:t.startMove}})]),i("div",{staticClass:"edit-poster",style:t.imageStyle},[i("el-image",{attrs:{src:t.url}})],1)]),i("div",{staticClass:"flex"},[i("div",{ref:"canvas-poster",staticClass:"edit-poster",style:t.imageStyle},[i("canvas",{ref:"canvas",style:t.imageStyle,attrs:{width:t.image.clientWidth*t.output.scale,height:t.image.clientHeight*t.output.scale}})]),i("div",{staticClass:"edit-poster",style:t.imageStyle},[i("el-image",{attrs:{src:t.output.src}})],1)]),i("div",{staticClass:"flex"},[i("ul",[i("li",[t._v("图像信息")]),i("li",[t._v("比例：1:"+t._s(t.image.ratio))]),i("li",[t._v("尺寸："+t._s(t.image.width.toFixed(2))+"x"+t._s(t.image.height.toFixed(2)))]),i("li",[t._v("预览尺寸："+t._s(t.image.clientWidth.toFixed(2))+"x"+t._s(t.image.clientHeight.toFixed(2)))])]),i("ul",[i("li",[t._v("二维码信息")]),i("li",[t._v("位置："+t._s((t.qrcode.top*t.output.scale).toFixed(2))+"x"+t._s((t.qrcode.left*t.output.scale).toFixed(2)))]),i("li",[t._v("尺寸："+t._s((t.qrcode.width*t.output.scale).toFixed(2))+"x"+t._s((t.qrcode.height*t.output.scale).toFixed(2)))])]),i("ul",[i("li",[t._v("输出图像信息")]),i("li",[t._v("倍率: "),i("el-input-number",{attrs:{size:"small",min:.5,step:.5,max:50},model:{value:t.output.scale,callback:function(e){t.$set(t.output,"scale",e)},expression:"output.scale"}})],1),i("li",[t._v("尺寸："+t._s((t.image.clientWidth*t.output.scale).toFixed(2))+"x"+t._s((t.image.clientHeight*t.output.scale).toFixed(2)))])]),i("el-button",{attrs:{size:"small",type:"danger"},on:{click:t.publishPoster}},[t._v("生成海报")])],1),i("label",{staticStyle:{padding:"0 20px"}},[t._v("二维码")]),i("el-input",{staticStyle:{width:"30%"},attrs:{size:"small"},model:{value:t.qrcode.text,callback:function(e){t.$set(t.qrcode,"text",e)},expression:"qrcode.text"}})],1)],1)},s=[],n=i("c0e9d"),o=i.n(n),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"gallery",on:{drop:function(e){return t.dropHandler(e)},dragover:t.dropoverHandler}},[i("el-upload",{staticClass:"file-upload",attrs:{action:"#","on-change":t.fileChangeHandle,"auto-upload":!1,accept:".png, .jpg, .jpeg, .bmp","show-file-list":!1}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),i("ul",t._l(t.list,(function(e,a){return i("li",{key:a,style:{width:t.width},attrs:{draggable:t.draggable},on:{dragstart:function(i){return t.dragstartHandler(i,e)}}},[i("el-image",{attrs:{src:e.value,fit:"scale-down"}}),i("div",{staticClass:"detail"},[i("p",[t._v(t._s(e.label)+" ")]),i("p",[t._v(t._s(e.size)+" ")])])],1)})),0)],1)},r=[],c=(i("4160"),i("a9e3"),i("d3b7"),i("3ca3"),i("159b"),i("ddb0"),i("2b3d"),i("cf45")),d={name:"Gallery",props:{column:{type:Number,default:1},draggable:{type:Boolean,default:!1}},data:function(){return{list:[{label:"图片名称",value:"/assets/image.jpg",size:"12000"},{label:"图片名称",value:"/assets/logo.png",size:"12000"},{label:"图片名称",value:"/assets/poster.jpg",size:"12000"},{label:"图片名称",value:"/assets/socket.png",size:"12000"},{label:"图片名称",value:"/assets/image.jpg",size:"12000"},{label:"图片名称",value:"/assets/image.jpg",size:"12000"},{label:"图片名称",value:"/assets/logo.png",size:"12000"},{label:"图片名称",value:"/assets/poster.jpg",size:"12000"}]}},computed:{width:function(){return Math.floor(100/this.column)+"%"}},methods:{dragstartHandler:function(t,e){t.dataTransfer.setData("image",JSON.stringify(e))},dropHandler:function(t){var e=this;t.preventDefault(),console.log("files",t.dataTransfer.files.length),t.dataTransfer.files.length&&t.dataTransfer.files.forEach((function(t){Object(c["c"])(t,(function(i){e.list.push({label:t.name,value:window.URL.createObjectURL(i),size:t.size})}))}))},dropoverHandler:function(t){t.preventDefault()},fileChangeHandle:function(t,e){var i=this;Object(c["b"])(t.raw,(function(e){i.list.push({label:t.raw.name,value:e,size:t.size})}))}},mounted:function(){console.log(this.$el.clientWidth)}},h=d,u=(i("e585"),i("2877")),g=function(t){t.options.__source="src/components/Gallery.vue"},m=g,p=Object(u["a"])(h,l,r,!1,null,"1a9bb0da",null);"function"===typeof m&&m(p);var f=p.exports,v={name:"DOMCapture",components:{Gallery:f},data:function(){return{url:"",width:400,image:{url:null,ratio:1,size:0,width:0,height:0,clientWidth:0,clientHeight:0},qrcode:{text:"",mouseDown:!1,startX:0,startY:0,top:0,left:0,width:80,height:80},output:{scale:3,width:0,height:0,src:null},canvas:{ratio:1,width:0,height:0,image:new Image,context:null}}},computed:{qrStyle:function(){return{top:this.qrcode.top+"px",left:this.qrcode.left+"px",width:this.qrcode.width+"px",height:this.qrcode.height+"px"}},posterStyle:function(){return this.image.width>this.image.clientWidth&&this.image.clientWidth/this.image.width,{width:this.image.width+"px",height:this.image.width+"px"}},imageStyle:function(){return{width:this.image.clientWidth+"px",height:this.image.clientHeight+"px"}}},methods:{dropHandler:function(t){if(t.preventDefault(),t.dataTransfer.getData("image")){var e=JSON.parse(t.dataTransfer.getData("image"));this.image.url=e.value,this.loadImage(this.image.url)}},dropoverHandler:function(t){t.preventDefault()},getPixelRatio:function(t){var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e},animate:function(){this.canvas.context.clearRect(0,0,this.image.width,this.image.height),this.canvas.context.drawImage(this.canvas.image,0,0,this.image.width,this.image.height,0,0,this.image.clientWidth*this.output.scale,this.image.clientHeight*this.output.scale),this.canvas.context.fillStyle="#FFffff",this.canvas.context.strokeStyle="#0000FF",this.canvas.context.lineWidth=this.output.scale,this.canvas.context.fillRect(this.qrcode.left*this.output.scale,this.qrcode.top*this.output.scale,this.qrcode.width*this.output.scale,this.qrcode.height*this.output.scale),this.canvas.context.strokeRect(this.qrcode.left*this.output.scale,this.qrcode.top*this.output.scale,this.qrcode.width*this.output.scale,this.qrcode.height*this.output.scale),"requestAnimationFrame"in window?requestAnimationFrame(this.animate):"webkitRequestAnimationFrame"in window?webkitRequestAnimationFrame(this.animate):"msRequestAnimationFrame"in window?msRequestAnimationFrame(this.animate):"mozRequestAnimationFrame"in window&&mozRequestAnimationFrame(this.animate)},loadImage:function(t){var e=this;this.canvas.context=this.$refs["canvas"].getContext("2d");this.getPixelRatio(this.canvas.context);this.canvas.image.onload=function(){e.canvas.image.style.width=e.image.clientWidth+"px",e.canvas.image.style.height=e.image.clientHeight+"px",e.animate()},this.canvas.image.src=t},imageLoading:function(t){var e=new Image;e.src=this.image.url,this.image.width=e.width,this.image.height=e.height,console.log(e.src,e.width,e.height);var i=1;e.width>this.width&&(i=e.width/this.width,this.image.clientWidth=this.width,this.image.ratio=i),this.image.clientWidth=e.width/i,this.image.clientHeight=e.height/i,console.log(this.image)},startMove:function(t){t.preventDefault(),this.qrcode.mouseDown=!0,this.qrcode.top=t.currentTarget.offsetTop,this.qrcode.left=t.currentTarget.offsetLeft,this.qrcode.startX=t.clientX,this.qrcode.startY=t.clientY,document.addEventListener("mousemove",this.mouseMoveHandler.bind(this),!1),document.addEventListener("mouseup",this.mouseUpHandler.bind(this),!1)},mouseMoveHandler:function(t){if(this.qrcode.mouseDown){var e=t.clientX-this.qrcode.startX,i=t.clientY-this.qrcode.startY;this.qrcode.top+=i,this.qrcode.left+=e,this.qrcode.startX=t.clientX,this.qrcode.startY=t.clientY,this.qrcode.left<0&&(this.qrcode.left=0),this.qrcode.top<0&&(this.qrcode.top=0),this.qrcode.left+this.qrcode.width>=this.image.clientWidth&&(this.qrcode.left=this.image.clientWidth-this.qrcode.width),this.qrcode.top+this.qrcode.height>=this.image.clientHeight&&(this.qrcode.top=this.image.clientHeight-this.qrcode.height)}},mouseUpHandler:function(t){this.qrcode.mouseDown=!1,document.removeEventListener("mousemove",this.mouseMoveHandler.bind(this),!1),document.removeEventListener("mouseup",this.mouseUpHandler.bind(this),!1)},publishPoster:function(){var t=this;o()(this.$refs.poster,{scale:this.output.scale}).then((function(e){e&&(t.url=e.toDataURL("image/png"),console.log(t.url))}));var e=this.$refs["canvas"];console.log(e.toDataURL("image/png")),this.output.src=e.toDataURL("image/png")}}},w=v,x=(i("754d"),function(t){t.options.__source="src/guide/views/web/DOMCapture.vue"}),b=x,q=Object(u["a"])(w,a,s,!1,null,"5a1d2d98",null);"function"===typeof b&&b(q);e["default"]=q.exports},cf45:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return o}));i("c975"),i("d81d"),i("a9e3"),i("b680"),i("acd8"),i("4d63"),i("ac1f"),i("25f0"),i("466d"),i("1276");var a=i("53ca"),s=(i("5530"),function(t){var e=Number(t)||0,i="";i=e<102.4?e.toFixed(2)+"B":e<104857.6?(e/1024).toFixed(2)+"KB":e<107374182.4?(e/1048576).toFixed(2)+"MB":(e/1073741824).toFixed(2)+"GB";var a=i+"",s=a.indexOf("."),n=a.substr(s+1,2);return"00"==n?a.substring(0,s)+a.substr(s+3,2):a}),n=function(t,e){var i=null,s=new FileReader;s.addEventListener("load",(function(s){i="object"===Object(a["a"])(s.target.result)?new Blob([s.target.result],{type:t.type}):s.target.result,e(i)})),s.readAsArrayBuffer(t)},o=function(t,e){var i=new FileReader;i.addEventListener("load",(function(t){e(i.result)})),i.readAsDataURL(t)}},e585:function(t,e,i){"use strict";var a=i("6ea5"),s=i.n(a);s.a}}]);