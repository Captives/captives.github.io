(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8eaf0de"],{10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},5e3:function(t,e,n){"use strict";var a=n("6a2a"),i=n.n(a);i.a},"6a2a":function(t,e,n){},9:function(t,e){},e31f:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",[n("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"center"},[n("canvas",{ref:"canvas"}),n("el-row",{staticClass:"control-bar"},[n("el-col",{attrs:{span:20}},[n("el-pagination",{attrs:{"page-size":1,"pager-count":7,layout:"prev, pager, next","hide-on-single-page":!0,total:t.pages},on:{"current-change":t.init}})],1),n("el-col",{attrs:{span:4}},[n("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.openHandler}},[t._v("新页面打开")])],1)],1)],1),n("el-aside",{attrs:{width:"40%"}},[n("p",[t._v("1、安装pdfjs依赖")]),n("vue-code",[n("pre",{attrs:{lang:"javascript"}},[t._v("npm install pdfjs-dist --save-dev")])]),n("p",[t._v("2、引用")]),n("vue-code",[n("pre",{attrs:{lang:"javascript"}},[t._v("import PDF from 'pdfjs-dist'\n\nPDF.disableWorker = true;\nconst loadingTask = PDF.getDocument(this.url);\nloadingTask.promise.then(PDFDocument => {\n    this.pdf = PDFDocument;\n    this.pages = PDFDocument.numPages;\n    this.pdf.getPage(num).then(this.renderPage);\n});\n")])]),n("p",[t._v("3、使用canvas作为预览pdf文件的画布")]),n("span",{staticStyle:{"font-size":"13px"}},[t._v(" 每个PDF页面都有其自己的视口，该视口定义了以像素为单位的大小（72DPI）和初始旋转。 默认情况下，视口会缩放为PDF的原始大小，但是可以通过修改视口来更改。 创建视口时，还将创建一个初始转换矩阵，该矩阵考虑了所需的比例和旋转，并转换坐标系 ")]),n("vue-code",[n("pre",{attrs:{lang:"html"}},[t._v('<canvas ref="canvas"></canvas>\n')]),n("pre",{attrs:{lang:"javascript"}},[t._v("var canvas = this.$refs.canvas;\nvar context = canvas.getContext('2d');\n\nconst getStyle = (obj, attr) => {\n    return obj.currentStyle ? obj.currentStyle[attr] : document.defaultView.getComputedStyle(obj, null)[attr];\n}\n\nconst dpr = window.devicePixelRatio || 1\nconst bsr = context.webkitBackingStorePixelRatio ||\ncontext.mozBackingStorePixelRatio ||\ncontext.msBackingStorePixelRatio ||\ncontext.oBackingStorePixelRatio ||\ncontext.backingStorePixelRatio || 1\nconst ratio = dpr / bsr;\n\nconst padding = parseInt(getStyle(canvas.parentNode, 'padding-left')) * 2;\nconst viewport = page.getViewport((canvas.parentNode.clientWidth - padding) / page.getViewport(1).width);\ncanvas.width = viewport.width * ratio;\ncanvas.height = viewport.height * ratio;\ncanvas.style.width = viewport.width + 'px';\ncanvas.style.height = viewport.height + 'px';\n")])]),n("p",[t._v("4、渲染页面")]),n("vue-code",[n("pre",{attrs:{lang:"javascript"}},[t._v("page.render({ canvasContext: context, viewport: viewport });")])]),n("p",[t._v(" 4、"),n("source-code",{attrs:{value:[{value:"webrtc/views/web/PDFJs.vue",lang:"html"}]}},[t._v("查看源码")])],1)],1)],1)},i=[],o=(n("e25e"),n("9511")),r=n.n(o),s={name:"PDFJs",data:function(){return{loading:!1,url:"/assets/color-card.pdf",pdf:null,pages:0,page:null,ratio:1}},mounted:function(){var t=this;r.a.disableWorker=!0;var e=r.a.getDocument(this.url);e.onProgress=function(t){t.loaded,t.total},e.promise.then((function(e){t.pdf=e,t.pages=e.numPages,e.getData().then((function(t){})),e.getDownloadInfo().then((function(t){var e=t.length;console.log("文件大小",e)})),e.getMetadata().then((function(t){var e=t.info,n=t.metadata;console.log("getMetadata",e,n)})),e.getOutline().then((function(t){console.log("getOutline",t)})),t.init(1)}))},methods:{init:function(t){this.pdf.getPage(t).then(this.renderPage)},renderPage:function(t){this.page=t;var e=this.$refs.canvas,n=e.getContext("2d"),a=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null)[e]},i=window.devicePixelRatio||1,o=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;this.ratio=this.ratio||i/o;var r=2*parseInt(a(e.parentNode,"padding-left")),s=t.getViewport((e.parentNode.clientWidth-r)/t.getViewport(1).width);e.width=s.width*this.ratio,e.height=s.height*this.ratio,e.style.width=s.width+"px",e.style.height=s.height+"px",t.render({canvasContext:n,viewport:s})},openHandler:function(){window.open("/pdfview/index.html?file="+this.url)}}},c=s,l=(n("5000"),n("2877")),d=Object(l["a"])(c,a,i,!1,null,"df94b5c2",null);e["default"]=d.exports}}]);